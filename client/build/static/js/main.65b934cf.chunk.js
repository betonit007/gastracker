(this.webpackJsonpfuelocr=this.webpackJsonpfuelocr||[]).push([[0],{33:function(e,t,a){e.exports=a.p+"static/media/loading.2fb6e0a7.gif"},35:function(e,t,a){e.exports=a(67)},40:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(15),c=a.n(l),o=(a(40),a(12)),s=a(14),u=a(3),i=a.n(u),m=a(9),d=a(1),p=a(5),E=a.n(p),f=Object(n.createContext)(),g=a(2),b=function(e,t){switch(t.type){case"USER_LOADED":return Object(g.a)({},e,{isAuthenticated:!0,loading:!1,user:t.payload,saved:t.payload.savedCars});case"REGISTER_SUCCESS":case"LOGIN_SUCCESS":return localStorage.setItem("token",t.payload.token),Object(g.a)({},e,{},t.payload,{isAuthenticated:!0,loading:!1});case"REGISTER_FAIL":case"AUTH_ERROR":case"LOGOUT":case"LOGIN_FAIL":return localStorage.removeItem("token"),Object(g.a)({},e,{token:null,isAuthenticated:!1,loading:!1,user:null,error:t.payload,saved:[]});case"CLEAR_ERRORS":return Object(g.a)({},e,{error:null});case"SET_LOADING":return Object(g.a)({},e,{loading:!0});default:return e}},v=function(e){e?E.a.defaults.headers.common["x-auth-token"]=e:delete E.a.defaults.headers.common["x-auth-token"]},h=function(e){var t={token:localStorage.getItem("token"),isAuthenticated:null,loading:!0,user:null,error:null,registerPage:!1,saved:[]},a=Object(n.useReducer)(b,t),l=Object(d.a)(a,2),c=l[0],o=l[1],s=function(){var e=Object(m.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.token){e.next=12;break}return v(localStorage.token),e.prev=2,e.next=5,E.a.get("/api/auth");case 5:t=e.sent,o({type:"USER_LOADED",payload:t.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),o({type:"AUTH_ERROR"});case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(m.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,E.a.post("/api/users",t,a);case 4:n=e.sent,o({type:"REGISTER_SUCCESS",payload:n.data}),s(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),o({type:"REGISTER_FAIL",payload:e.t0.response.data.msg});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(m.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,E.a.post("api/auth",t,a);case 4:n=e.sent,o({type:"LOGIN_SUCCESS",payload:n.data}),s(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),o({type:"LOGIN_FAIL",payload:e.t0.response.data.msg});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(f.Provider,{value:{token:c.token,isAuthenticated:c.isAuthenticated,loading:c.loading,user:c.user,error:c.error,registerPage:c.registerPage,register:u,loadUser:s,login:p,logout:function(){return o({type:"LOGOUT"})},clearErrors:function(){o({type:"CLEAR_ERRORS"})},setLoading:function(){o({type:"SET_LOADING"})}}},e.children)},O=Object(n.createContext)(),y=a(34),N=function(e,t){switch(t.type){case"DELETE_TRANSACTION":return Object(g.a)({},e,{transactions:e.transactions.filter((function(e){return e._id!==t.payload}))});case"ADD_TRANSACTION":return Object(g.a)({},e,{transactions:[t.payload].concat(Object(y.a)(e.transactions))});case"USER_TRANSACTIONS":return Object(g.a)({},e,{transactions:t.payload.res,millisecs:t.payload.millisecs,loading:!1});case"CHANGE_DAYS":return Object(g.a)({},e,{millisecs:t.payload});case"CLEAR_TRANSSTATE":return Object(g.a)({},e,{transactions:[]});case"SINGLE_TRANS":return Object(g.a)({},e,{selectedTrans:t.payload});case"UPDATE_TRANSACTION":var a=t.payload,n=a._id,r=a.store,l=a.gallons,c=a.total,o=a.street,s=a.city,u=a.state;return Object(g.a)({},e,{transactions:e.transactions.map((function(e){return e._id===n?Object(g.a)({},e,{store:r,gallons:l,total:c,street:o,city:s,state:u}):e}))});case"SET_LOADING":return Object(g.a)({},e,{loading:!0});case"FINAL_RESULTS":return Object(g.a)({},e,{finalResult:t.payload});default:return e}},j=function(e){var t=Object(n.useReducer)(N,{transactions:[],selectedTrans:{},finalResult:{},loading:!0,millisecs:6048e5}),a=Object(d.a)(t,2),l=a[0],c=a[1],o=function(){var e=Object(m.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={headers:{"Content-Type":"application/json"}};try{E.a.put("/api/readings/",t,a),c({type:"UPDATE_TRANSACTION",payload:t})}catch(n){console.log(n)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(m.a)(i.a.mark((function e(t){var a,n,r=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:6048e5,f(),e.prev=2,e.next=5,E.a.get("/api/readings/".concat(t,"/").concat(a));case 5:n=e.sent,c({type:"USER_TRANSACTIONS",payload:{res:n.data,millisecs:a}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(m.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{"Content-Type":"application/json"}},e.prev=1,e.next=4,E.a.post("/api/readings",t,a);case 4:n=e.sent,c({type:"ADD_TRANSACTION",payload:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(m.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.delete("/api/readings/".concat(t));case 3:c({type:"DELETE_TRANSACTION",payload:t}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){c({type:"SET_LOADING"})};return r.a.createElement(O.Provider,{value:{transactions:l.transactions,loading:l.loading,millisecs:l.millisecs,selectedTrans:l.selectedTrans,finalResult:l.finalResult,getUserTransactions:s,deleteTransaction:p,addTransaction:u,clearTransState:function(){c({type:"CLEAR_TRANSSTATE"})},getSingleTransaction:function(e){var t=l.transactions.find((function(t){return t._id===e}));c({type:"SINGLE_TRANS",payload:t})},updateTransaction:o,setLoading:f,formatVisionResponse:function(e){for(var t=0;t<=3;t++){if(e[t].indexOf("Sheetz")>-1||e[t].indexOf("SHEETZ")>-1){var a={store:e[0],street:e[2],gallons:e[10],total:e[11],state:e[4],city:e[3]};console.log(a),c({type:"FINAL_RESULTS",payload:a})}(e[t].indexOf("Shell")>-1||e[t].indexOf("SHELL")>-1)&&console.log("shell"),(e[t].indexOf("Dans")>-1||e[t].indexOf("DANS")>-1)&&console.log("shell")}}}},e.children)},S=a(30),C=function(e){var t=e.component,a=Object(S.a)(e,["component"]),l=Object(n.useContext)(f).isAuthenticated;return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return l?r.a.createElement(t,e):r.a.createElement(s.a,{to:"/"})}}))},x=function(){var e=Object(n.useContext)(f),t=e.register,a=e.isAuthenticated,l=e.loadUser,c=Object(n.useState)(""),u=Object(d.a)(c,2),i=u[0],m=u[1],p=Object(n.useState)(""),E=Object(d.a)(p,2),g=E[0],b=E[1],v=Object(n.useState)(""),h=Object(d.a)(v,2),O=h[0],y=h[1],N=Object(n.useState)(""),j=Object(d.a)(N,2),S=j[0],C=j[1];if(Object(n.useEffect)((function(){l()})),a)return r.a.createElement(s.a,{to:"/main"});return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"registerH3"},"Register"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),""===i||""===g||""===O?alert("Please enter all fields","danger"):O!==S&&O.length>6?alert("Passwords do not match","danger"):t({name:i,email:g,password:O})}},r.a.createElement("div",{className:""},r.a.createElement("input",{value:i,onChange:function(e){return m(e.target.value)},type:"text",placeholder:"Name",className:"text",required:!0}),r.a.createElement("input",{value:g,onChange:function(e){return b(e.target.value)},type:"email",placeholder:"Email",className:"text",required:!0}),r.a.createElement("input",{value:O,onChange:function(e){return y(e.target.value)},type:"password",placeholder:"Password",className:"text",required:!0}),r.a.createElement("input",{value:S,onChange:function(e){return C(e.target.value)},type:"password",placeholder:"Confirm Password",className:"text",required:!0})),r.a.createElement("input",{type:"submit",value:"Register",className:"btn"})),r.a.createElement(o.b,{to:"/"},"Return to Main"))},T=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(""),o=Object(d.a)(c,2),u=o[0],i=o[1],m=Object(n.useContext)(f),p=Object(n.useContext)(O).clearTransState,E="/register"===Object(s.g)().pathname?{display:"none"}:{};return r.a.createElement("div",{className:"header",style:E},r.a.createElement("h4",{className:"underline-header"},"FuelOCR"),m.isAuthenticated?r.a.createElement("div",{className:"userLoggedIn header"},r.a.createElement("h1",{className:"welcome-user"},"Welcome ",m.user&&m.user.name),r.a.createElement("div",{className:"logout-button"},r.a.createElement("button",{className:"btn",onClick:function(){return m.logout(),void p()}},"Logout"))):m.isAuthenticated||m.registerPage?r.a.createElement(x,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("form",null,r.a.createElement("div",{className:"loginFields"},r.a.createElement("input",{value:a,onChange:function(e){return l(e.target.value)},type:"text",placeholder:"Email",className:"text"}),r.a.createElement("input",{value:u,onChange:function(e){return i(e.target.value)},type:"password",placeholder:"Password",className:"text"})),r.a.createElement("button",{className:"btn",onClick:function(e){return function(e){e.preventDefault(),m.login({email:a,password:u})}(e)}},"Login"))))},A=function(){localStorage.token&&v(localStorage.token);var e=Object(n.useContext)(f),t=e.isAuthenticated,a=e.loadUser;return Object(n.useEffect)((function(){a()})),t?r.a.createElement(s.a,{to:"/main"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"register"},r.a.createElement("p",null,"Don't have an account? "),r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(o.b,{to:"/register"}," ","click here to register")))))},R=a(33),k=a.n(R),_=function(){return r.a.createElement("div",{className:"loading-gif"},r.a.createElement("img",{src:k.a,alt:"Loading"}))},F=function(){var e=Object(n.useContext)(O),t=e.transactions,a=e.loading,l=t.reduce((function(e,t){return e+t.total}),0).toFixed(2);return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Your Balance"),r.a.createElement("h1",null,a?"Loading...":"$".concat(l)))},L=a(13),w=function(e){var t=e.toggleModal,a=Object(n.useContext)(O),l=a.selectedTrans,c=a.deleteTransaction,o=a.updateTransaction,s=l.store,u=l.street,i=l.gallons,m=l.total,p=l.state,E=l.city,f=l._id,b=Object(n.useState)({_id:f,store:s,street:u,gallons:i,total:m,state:p,city:E}),v=Object(d.a)(b,2),h=v[0],y=v[1],N=Object(n.useState)(!1),j=Object(d.a)(N,2),S=j[0],C=j[1],x=function(e){y(Object(g.a)({},h,Object(L.a)({},e.target.name,e.target.value)))},T=function(e){y(Object(g.a)({},h,Object(L.a)({},e.target.name,parseFloat(e.target.value))))},A=function(){C(!S)};return r.a.createElement("div",{className:"modal-margin"},r.a.createElement("h3",{style:{textAlign:"center"}},"Edit / Delete"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"store"},"Store"),r.a.createElement("input",{onChange:function(e){return x(e)},type:"text",placeholder:"Enter store name...",className:"text",name:"store",value:h.store}),r.a.createElement("label",{htmlFor:"street address"},"Street Address"),r.a.createElement("input",{value:h.street,onChange:function(e){return x(e)},type:"text",placeholder:"Enter street address...",name:"street"}),r.a.createElement("label",{htmlFor:"amount"},"Number of gallons"),r.a.createElement("input",{onChange:function(e){return T(e)},type:"number",placeholder:"Enter number of gallons...",name:"gallons",value:h.gallons}),r.a.createElement("label",{htmlFor:"amount"},"Amount"),r.a.createElement("input",{onChange:function(e){return T(e)},type:"number",placeholder:"Enter total...",name:"total",value:h.total}))),S?r.a.createElement("div",{className:"edit-delete"},r.a.createElement("button",{className:"btn btn-delete",style:{margin:"10px 5px 30px 0"},onClick:function(){return c(f),void t()}},"Confirm"),r.a.createElement("button",{className:"btn",onClick:function(e){return A()}},"Cancel")):r.a.createElement("div",{className:"edit-delete"},r.a.createElement("button",{className:"btn",onClick:function(){return o(h),void t()}},"Update"),r.a.createElement("button",{className:"btn btn-delete",onClick:function(e){return A()}},"Delete")))},I=function(e){var t=e.toggleModal;return c.a.createPortal(r.a.createElement("div",{onClick:function(){return t(!1)},className:"modalContainer"},r.a.createElement("div",{className:"modalContent",onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"close-x",onClick:function(){return t(!1)}},r.a.createElement("span",null,"X")),r.a.createElement(w,{toggleModal:t}))),document.querySelector("#modal"))},D=function(e){var t=e.trans,a=Object(n.useContext)(O),l=a.deleteTransaction,c=a.getSingleTransaction,o=Object(n.useState)(!1),s=Object(d.a)(o,2),u=s[0],i=s[1];return r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(I,{deleteTransaction:l,trans:t,toggleModal:i}),r.a.createElement("div",{className:"single-transaction",onClick:function(){return e=t._id,c(e),void i(!0);var e}},r.a.createElement("li",{key:t.id},t.store," ",r.a.createElement("span",null,"$",t.total.toFixed(2)))))},U=function(e){var t=e.user,a=Object(n.useContext)(O),l=a.getUserTransactions,c=a.millisecs;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row",style:{marginLeft:"auto"}},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("form",{style:{display:"flex",alignContent:"flex-end"}},r.a.createElement("div",{className:"radio"},r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"option1",checked:6048e5===c,onChange:function(){return l(t,6048e5)}}),"7 days")),r.a.createElement("div",{className:"radio"},r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"option2",checked:2592e6===c,onChange:function(){return l(t,2592e6)}}),"30 days"))))))},P=function(){var e=Object(n.useContext)(O),t=e.getUserTransactions,a=e.loading,l=e.transactions,c=Object(n.useContext)(f).user;return Object(n.useEffect)((function(){c&&t(c._id)}),[c]),r.a.createElement("div",{className:"transaction-list"},r.a.createElement("header",{className:"underline-header"},r.a.createElement("h3",null,"History"),r.a.createElement(U,{user:c&&c._id})),a&&r.a.createElement(_,null),r.a.createElement("ul",{className:"list ".concat(a&&" fade")},l.map((function(e){return r.a.createElement(D,{key:e._id,trans:e})}))))},G=function(e){var t=e.vision,a=e.resetModal,l=Object(n.useContext)(O),c=l.addTransaction,o=(l.formatVisionResponse,l.finalResult,Object(n.useState)({store:t.store,street:t.street,gallons:t.gallons,total:t.total,state:t.state,city:t.city})),s=Object(d.a)(o,2),u=s[0],i=s[1],m=function(e){i(Object(g.a)({},u,Object(L.a)({},e.target.name,e.target.value)))},p=function(e){i(Object(g.a)({},u,Object(L.a)({},e.target.name,parseFloat(e.target.value))))};return r.a.createElement("div",{className:"modal-margin"},r.a.createElement("h3",{style:{textAlign:"center"}},"Verify Results"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"store"},"Store"),r.a.createElement("input",{onChange:function(e){return m(e)},type:"text",placeholder:"Enter store name...",className:"text",name:"store",value:u.store}),r.a.createElement("label",{htmlFor:"street address"},"Street Address"),r.a.createElement("input",{value:u.street,onChange:function(e){return m(e)},type:"text",placeholder:"Enter street address...",name:"street"}),r.a.createElement("label",{htmlFor:"amount"},"Number of gallons"),r.a.createElement("input",{onChange:function(e){return p(e)},type:"number",placeholder:"Enter number of gallons...",name:"gallons",value:parseFloat(u.gallons).toFixed(2)}),r.a.createElement("label",{htmlFor:"amount"},"Amount"),r.a.createElement("input",{onChange:function(e){return p(e)},type:"number",placeholder:"Enter total...",name:"total",value:parseFloat(u.total).toFixed(2)}),r.a.createElement("button",{className:"btn",onClick:function(e){return function(e){e.preventDefault(),c(u),a()}(e)}},"Add transaction"))))},M=function(e){var t=e.percentage;return r.a.createElement("div",{className:"filler",style:{width:"".concat(t,"%")}})},H=(a(64),function(e){var t=e.percentage;return r.a.createElement("div",{className:"progress-bar"},r.a.createElement(M,{percentage:t}))}),q=(a(65),function(e){var t=e.uploadFile,a=e.setFile,l=function(){a("")},o=Object(n.useState)(0),s=Object(d.a)(o,2),u=s[0],p=s[1],f=Object(n.useState)(null),g=Object(d.a)(f,2),b=g[0],v=g[1],h=function(){var e=Object(m.a)(i.a.mark((function e(a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(n=new FormData).append("file",t),e.prev=3,e.next=6,E.a.post("./api/readings/upload",n,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){p(parseInt(Math.round(100*e.loaded/e.total)))}});case 6:r=e.sent,v(r.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),500===e.t0.response.status?console.log("Problem with Server"):console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createPortal(r.a.createElement("div",{onClick:function(e){return l()},className:"modalContainer"},r.a.createElement("div",{className:"modalContent",onClick:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"close-x",onClick:function(e){return l()}},r.a.createElement("span",null,"X")),b?r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{vision:b,resetModal:l})):r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{percentage:u}),r.a.createElement("div",{className:"row mt-5"},r.a.createElement("div",{className:"col-md-6 m-auto"},r.a.createElement("img",{style:{width:"100%"},src:window.URL.createObjectURL(t),alt:"upload"})),r.a.createElement("form",{onSubmit:h},r.a.createElement("input",{type:"submit",value:"Upload",className:"btn btn-primary btn-block mt-4"})))))),document.querySelector("#modal"))}),V=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],l=t[1];return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement(q,{uploadFile:a,setFile:l}),r.a.createElement("label",{className:"btn btn-add-transaction"},r.a.createElement("input",{type:"file",style:{display:"none"},id:"customFile",onChange:function(e){return function(e){l(e.target.files[0])}(e)}}),r.a.createElement("span",{className:"addTrans"},"Add Transaction")))},B=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement(P,null),r.a.createElement(V,null))},J=(a(66),function(){return r.a.createElement(h,null,r.a.createElement(j,null,r.a.createElement(o.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container"},r.a.createElement(T,null),r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/",component:A}),r.a.createElement(s.b,{exact:!0,path:"/register",component:x}),r.a.createElement(C,{exact:!0,path:"/main",component:B})))))))});c.a.render(r.a.createElement(J,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.65b934cf.chunk.js.map